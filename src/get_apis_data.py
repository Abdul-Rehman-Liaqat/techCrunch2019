import requests
from typing import Dict, Optional
import os
import pandas as pd

latitude = 52.497139
longitude = 13.453778

def get_pollution_data(city: Optional[str]=None,location: Optional[Dict[str,float]] = None):

    def _append_api_token(url):
        return url + "/?token=" + os.getenv("POLLUTION_API_TOKEN")

    pollution_api_url = "http://api.waqi.info/feed/"
    if location is not None:
        api_path = _append_api_token("geo" + ":" + str(location["lat"]) + ";" + str(location["long"]))
        return requests.get(pollution_api_url + api_path).json()
    elif city is not None:
        api_path = _append_api_token(city)
        return requests.get(pollution_api_url+api_path).json()
    else:
        return None


from datetime import datetime

def get_weather_data(location: Dict[str,float]):
    weather_api_url = "https://api.darksky.net/forecast/"
    api_path = "{api_key}/{lat},{long}?units=si".format(lat=str(location["lat"]),long=str(location["long"]),api_key=os.getenv("WEATHER_API_TOKEN"))
    dummy_data = {'latitude': 52.497139, 'longitude': 13.453778, 'timezone': 'Europe/Berlin', 'currently': {'time': 1576150883, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 4.26, 'apparentTemperature': 1.39, 'dewPoint': 1.62, 'humidity': 0.83, 'pressure': 1003.1, 'windSpeed': 3.33, 'windGust': 6.98, 'windBearing': 216, 'cloudCover': 0.96, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 325.8}, 'hourly': {'summary': 'Partly cloudy throughout the day.', 'icon': 'partly-cloudy-day', 'data': [{'time': 1576148400, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 4.08, 'apparentTemperature': 1.17, 'dewPoint': 1.91, 'humidity': 0.86, 'pressure': 1003.3, 'windSpeed': 3.3, 'windGust': 6.82, 'windBearing': 219, 'cloudCover': 0.98, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 323.1}, {'time': 1576152000, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 4.3, 'apparentTemperature': 1.43, 'dewPoint': 1.48, 'humidity': 0.82, 'pressure': 1003, 'windSpeed': 3.32, 'windGust': 7.05, 'windBearing': 214, 'cloudCover': 0.95, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 326.8}, {'time': 1576155600, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 4.1, 'apparentTemperature': 1.23, 'dewPoint': 1.08, 'humidity': 0.81, 'pressure': 1002.7, 'windSpeed': 3.27, 'windGust': 7.28, 'windBearing': 207, 'cloudCover': 0.9, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 328.5}, {'time': 1576159200, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.76, 'apparentTemperature': 0.92, 'dewPoint': 0.68, 'humidity': 0.8, 'pressure': 1002.2, 'windSpeed': 3.12, 'windGust': 7.52, 'windBearing': 198, 'cloudCover': 0.84, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 329.1}, {'time': 1576162800, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0.0062, 'precipProbability': 0.09, 'precipType': 'rain', 'temperature': 3.38, 'apparentTemperature': 0.53, 'dewPoint': 0.43, 'humidity': 0.81, 'pressure': 1001.8, 'windSpeed': 3.03, 'windGust': 7.75, 'windBearing': 192, 'cloudCover': 0.78, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 329.8}, {'time': 1576166400, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0.0062, 'precipProbability': 0.09, 'precipType': 'rain', 'temperature': 3.1, 'apparentTemperature': 0.15, 'dewPoint': 0.29, 'humidity': 0.82, 'pressure': 1001.6, 'windSpeed': 3.09, 'windGust': 7.96, 'windBearing': 186, 'cloudCover': 0.76, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 331.6}, {'time': 1576170000, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.87, 'apparentTemperature': -0.23, 'dewPoint': 0.16, 'humidity': 0.82, 'pressure': 1001.3, 'windSpeed': 3.23, 'windGust': 8.15, 'windBearing': 182, 'cloudCover': 0.75, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 333.5}, {'time': 1576173600, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.78, 'apparentTemperature': -0.45, 'dewPoint': 0.16, 'humidity': 0.83, 'pressure': 1001, 'windSpeed': 3.38, 'windGust': 8.35, 'windBearing': 177, 'cloudCover': 0.71, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 335}, {'time': 1576177200, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.86, 'apparentTemperature': -0.46, 'dewPoint': 0.31, 'humidity': 0.83, 'pressure': 1000.3, 'windSpeed': 3.52, 'windGust': 8.47, 'windBearing': 173, 'cloudCover': 0.57, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 335.7}, {'time': 1576180800, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.02, 'apparentTemperature': -0.36, 'dewPoint': 0.53, 'humidity': 0.84, 'pressure': 999.6, 'windSpeed': 3.66, 'windGust': 8.6, 'windBearing': 170, 'cloudCover': 0.39, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 335.9}, {'time': 1576184400, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.11, 'apparentTemperature': -0.35, 'dewPoint': 0.69, 'humidity': 0.84, 'pressure': 998.7, 'windSpeed': 3.83, 'windGust': 8.85, 'windBearing': 167, 'cloudCover': 0.28, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 337}, {'time': 1576188000, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.01, 'apparentTemperature': -0.57, 'dewPoint': 0.59, 'humidity': 0.84, 'pressure': 997.8, 'windSpeed': 3.99, 'windGust': 9.33, 'windBearing': 164, 'cloudCover': 0.34, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 339.6}, {'time': 1576191600, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0.0062, 'precipProbability': 0.04, 'precipType': 'rain', 'temperature': 2.78, 'apparentTemperature': -0.96, 'dewPoint': 0.29, 'humidity': 0.84, 'pressure': 996.9, 'windSpeed': 4.15, 'windGust': 9.96, 'windBearing': 162, 'cloudCover': 0.46, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 342.9}, {'time': 1576195200, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0.0072, 'precipProbability': 0.04, 'precipType': 'rain', 'temperature': 2.49, 'apparentTemperature': -1.43, 'dewPoint': 0.04, 'humidity': 0.84, 'pressure': 995.9, 'windSpeed': 4.34, 'windGust': 10.57, 'windBearing': 159, 'cloudCover': 0.51, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 345.4}, {'time': 1576198800, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.15, 'apparentTemperature': -1.97, 'dewPoint': -0.11, 'humidity': 0.85, 'pressure': 994.6, 'windSpeed': 4.53, 'windGust': 11.15, 'windBearing': 153, 'cloudCover': 0.39, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 346.5}, {'time': 1576202400, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 1.68, 'apparentTemperature': -2.68, 'dewPoint': -0.27, 'humidity': 0.87, 'pressure': 992.9, 'windSpeed': 4.74, 'windGust': 11.73, 'windBearing': 147, 'cloudCover': 0.2, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 346.8}, {'time': 1576206000, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 1.3, 'apparentTemperature': -3.29, 'dewPoint': -0.36, 'humidity': 0.89, 'pressure': 991.6, 'windSpeed': 4.99, 'windGust': 12.27, 'windBearing': 142, 'cloudCover': 0.05, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 345.6}, {'time': 1576209600, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 0.91, 'apparentTemperature': -3.93, 'dewPoint': -0.47, 'humidity': 0.9, 'pressure': 990.4, 'windSpeed': 5.28, 'windGust': 12.87, 'windBearing': 138, 'cloudCover': 0.02, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 341.9}, {'time': 1576213200, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 0.69, 'apparentTemperature': -4.38, 'dewPoint': -0.53, 'humidity': 0.92, 'pressure': 989.6, 'windSpeed': 5.6, 'windGust': 13.45, 'windBearing': 135, 'cloudCover': 0.02, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 336.7}, {'time': 1576216800, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 0.56, 'apparentTemperature': -4.66, 'dewPoint': -0.43, 'humidity': 0.93, 'pressure': 988.6, 'windSpeed': 5.84, 'windGust': 13.76, 'windBearing': 133, 'cloudCover': 0.03, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 331.9}, {'time': 1576220400, 'summary': 'Clear', 'icon': 'clear-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 0.8, 'apparentTemperature': -4.43, 'dewPoint': -0.32, 'humidity': 0.92, 'pressure': 987.7, 'windSpeed': 5.98, 'windGust': 13.67, 'windBearing': 132, 'cloudCover': 0.02, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 327.8}, {'time': 1576224000, 'summary': 'Clear', 'icon': 'clear-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 0.94, 'apparentTemperature': -4.27, 'dewPoint': -0.41, 'humidity': 0.91, 'pressure': 986.8, 'windSpeed': 6.03, 'windGust': 13.32, 'windBearing': 132, 'cloudCover': 0.01, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 324.1}, {'time': 1576227600, 'summary': 'Clear', 'icon': 'clear-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 1.3, 'apparentTemperature': -3.81, 'dewPoint': -0.38, 'humidity': 0.89, 'pressure': 986.1, 'windSpeed': 6.02, 'windGust': 12.79, 'windBearing': 134, 'cloudCover': 0, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 321}, {'time': 1576231200, 'summary': 'Clear', 'icon': 'clear-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 1.82, 'apparentTemperature': -3.11, 'dewPoint': -0.3, 'humidity': 0.86, 'pressure': 985.5, 'windSpeed': 5.93, 'windGust': 12.05, 'windBearing': 134, 'cloudCover': 0, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 318.8}, {'time': 1576234800, 'summary': 'Clear', 'icon': 'clear-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.58, 'apparentTemperature': -2.08, 'dewPoint': -0.26, 'humidity': 0.82, 'pressure': 984.9, 'windSpeed': 5.78, 'windGust': 11.13, 'windBearing': 134, 'cloudCover': 0, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 317.4}, {'time': 1576238400, 'summary': 'Clear', 'icon': 'clear-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.16, 'apparentTemperature': -1.24, 'dewPoint': -0.4, 'humidity': 0.78, 'pressure': 984.4, 'windSpeed': 5.56, 'windGust': 10.39, 'windBearing': 135, 'cloudCover': 0, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 316.3}, {'time': 1576242000, 'summary': 'Clear', 'icon': 'clear-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.26, 'apparentTemperature': -0.96, 'dewPoint': -0.85, 'humidity': 0.74, 'pressure': 984, 'windSpeed': 5.24, 'windGust': 10.02, 'windBearing': 135, 'cloudCover': 0.17, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 315.6}, {'time': 1576245600, 'summary': 'Partly Cloudy', 'icon': 'partly-cloudy-day', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.99, 'apparentTemperature': -1.1, 'dewPoint': -1.47, 'humidity': 0.73, 'pressure': 983.9, 'windSpeed': 4.85, 'windGust': 9.82, 'windBearing': 135, 'cloudCover': 0.41, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 315.3}, {'time': 1576249200, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0.0062, 'precipProbability': 0.12, 'precipType': 'rain', 'temperature': 2.77, 'apparentTemperature': -1.21, 'dewPoint': -1.75, 'humidity': 0.72, 'pressure': 983.9, 'windSpeed': 4.55, 'windGust': 9.61, 'windBearing': 138, 'cloudCover': 0.61, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 315.4}, {'time': 1576252800, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.44, 'apparentTemperature': -1.53, 'dewPoint': -1.78, 'humidity': 0.74, 'pressure': 984, 'windSpeed': 4.38, 'windGust': 9.17, 'windBearing': 142, 'cloudCover': 0.7, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 316}, {'time': 1576256400, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.27, 'apparentTemperature': -1.68, 'dewPoint': -1.48, 'humidity': 0.76, 'pressure': 984.7, 'windSpeed': 4.29, 'windGust': 8.7, 'windBearing': 147, 'cloudCover': 0.74, 'uvIndex': 0, 'visibility': 10.321, 'ozone': 317.1}, {'time': 1576260000, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 2.26, 'apparentTemperature': -1.65, 'dewPoint': -1.11, 'humidity': 0.78, 'pressure': 984.8, 'windSpeed': 4.23, 'windGust': 8.6, 'windBearing': 154, 'cloudCover': 0.79, 'uvIndex': 0, 'visibility': 6.379, 'ozone': 318.3}, {'time': 1576263600, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-night', 'precipIntensity': 0.0058, 'precipProbability': 0.11, 'precipType': 'rain', 'temperature': 2.51, 'apparentTemperature': -1.28, 'dewPoint': -0.73, 'humidity': 0.79, 'pressure': 984.8, 'windSpeed': 4.13, 'windGust': 9.27, 'windBearing': 162, 'cloudCover': 0.87, 'uvIndex': 0, 'visibility': 10.807, 'ozone': 319.5}, {'time': 1576267200, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.0286, 'precipProbability': 0.11, 'precipType': 'rain', 'temperature': 2.79, 'apparentTemperature': -0.84, 'dewPoint': -0.35, 'humidity': 0.8, 'pressure': 985.2, 'windSpeed': 3.98, 'windGust': 10.3, 'windBearing': 173, 'cloudCover': 0.95, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 321}, {'time': 1576270800, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.0676, 'precipProbability': 0.12, 'precipType': 'rain', 'temperature': 3.02, 'apparentTemperature': -0.48, 'dewPoint': 0.16, 'humidity': 0.81, 'pressure': 985.8, 'windSpeed': 3.85, 'windGust': 10.84, 'windBearing': 183, 'cloudCover': 1, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 322.7}, {'time': 1576274400, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.1505, 'precipProbability': 0.21, 'precipType': 'rain', 'temperature': 3.34, 'apparentTemperature': -0.15, 'dewPoint': 1.15, 'humidity': 0.86, 'pressure': 986.2, 'windSpeed': 3.95, 'windGust': 10.43, 'windBearing': 194, 'cloudCover': 1, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 325.8}, {'time': 1576278000, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.3031, 'precipProbability': 0.34, 'precipType': 'rain', 'temperature': 3.64, 'apparentTemperature': 0.11, 'dewPoint': 2.14, 'humidity': 0.9, 'pressure': 986.6, 'windSpeed': 4.13, 'windGust': 9.55, 'windBearing': 206, 'cloudCover': 0.99, 'uvIndex': 0, 'visibility': 14.608, 'ozone': 329.3}, {'time': 1576281600, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.3819, 'precipProbability': 0.36, 'precipType': 'rain', 'temperature': 3.92, 'apparentTemperature': 0.39, 'dewPoint': 2.75, 'humidity': 0.92, 'pressure': 987, 'windSpeed': 4.24, 'windGust': 8.77, 'windBearing': 210, 'cloudCover': 0.98, 'uvIndex': 0, 'visibility': 11.049, 'ozone': 330.6}, {'time': 1576285200, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.2204, 'precipProbability': 0.31, 'precipType': 'rain', 'temperature': 4.06, 'apparentTemperature': 0.47, 'dewPoint': 3.17, 'humidity': 0.94, 'pressure': 987.4, 'windSpeed': 4.42, 'windGust': 8.12, 'windBearing': 216, 'cloudCover': 0.97, 'uvIndex': 0, 'visibility': 14.065, 'ozone': 328.1}, {'time': 1576288800, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.0461, 'precipProbability': 0.14, 'precipType': 'rain', 'temperature': 4.23, 'apparentTemperature': 0.55, 'dewPoint': 3.39, 'humidity': 0.94, 'pressure': 987.8, 'windSpeed': 4.66, 'windGust': 7.6, 'windBearing': 221, 'cloudCover': 0.97, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 323.3}, {'time': 1576292400, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.0122, 'precipProbability': 0.09, 'precipType': 'rain', 'temperature': 3.94, 'apparentTemperature': 0.98, 'dewPoint': 2.86, 'humidity': 0.93, 'pressure': 988, 'windSpeed': 3.35, 'windGust': 7.65, 'windBearing': 227, 'cloudCover': 0.96, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 319.4}, {'time': 1576296000, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.0798, 'precipProbability': 0.3, 'precipType': 'rain', 'temperature': 4.25, 'apparentTemperature': 0.21, 'dewPoint': 3.58, 'humidity': 0.95, 'pressure': 988.8, 'windSpeed': 5.4, 'windGust': 8.82, 'windBearing': 220, 'cloudCover': 0.97, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 317.4}, {'time': 1576299600, 'summary': 'Possible Drizzle', 'icon': 'rain', 'precipIntensity': 0.2741, 'precipProbability': 0.51, 'precipType': 'rain', 'temperature': 3.96, 'apparentTemperature': -0.15, 'dewPoint': 3.33, 'humidity': 0.96, 'pressure': 989.4, 'windSpeed': 5.39, 'windGust': 10.57, 'windBearing': 215, 'cloudCover': 0.98, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 316.2}, {'time': 1576303200, 'summary': 'Possible Light Rain', 'icon': 'rain', 'precipIntensity': 0.4099, 'precipProbability': 0.55, 'precipType': 'rain', 'temperature': 3.91, 'apparentTemperature': -0.23, 'dewPoint': 3.27, 'humidity': 0.96, 'pressure': 989.9, 'windSpeed': 5.42, 'windGust': 11.77, 'windBearing': 215, 'cloudCover': 0.98, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 315.4}, {'time': 1576306800, 'summary': 'Possible Drizzle', 'icon': 'rain', 'precipIntensity': 0.2301, 'precipProbability': 0.42, 'precipType': 'rain', 'temperature': 4.06, 'apparentTemperature': -0.07, 'dewPoint': 3.14, 'humidity': 0.94, 'pressure': 990.2, 'windSpeed': 5.48, 'windGust': 11.78, 'windBearing': 211, 'cloudCover': 0.96, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 315.1}, {'time': 1576310400, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0.0358, 'precipProbability': 0.14, 'precipType': 'rain', 'temperature': 3.96, 'apparentTemperature': -0.21, 'dewPoint': 2.67, 'humidity': 0.91, 'pressure': 990.2, 'windSpeed': 5.51, 'windGust': 11.25, 'windBearing': 205, 'cloudCover': 0.94, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 315.2}, {'time': 1576314000, 'summary': 'Overcast', 'icon': 'cloudy', 'precipIntensity': 0, 'precipProbability': 0, 'temperature': 3.82, 'apparentTemperature': -0.44, 'dewPoint': 2.38, 'humidity': 0.9, 'pressure': 989.8, 'windSpeed': 5.64, 'windGust': 10.91, 'windBearing': 199, 'cloudCover': 0.9, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 314.9}, {'time': 1576317600, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-day', 'precipIntensity': 0.0576, 'precipProbability': 0.17, 'precipType': 'rain', 'temperature': 3.59, 'apparentTemperature': -0.85, 'dewPoint': 2.31, 'humidity': 0.91, 'pressure': 989.7, 'windSpeed': 5.91, 'windGust': 10.9, 'windBearing': 193, 'cloudCover': 0.84, 'uvIndex': 0, 'visibility': 16.093, 'ozone': 313.9}, {'time': 1576321200, 'summary': 'Mostly Cloudy', 'icon': 'partly-cloudy-day', 'precipIntensity': 0.2677, 'precipProbability': 0.33, 'precipType': 'rain', 'temperature': 3.32, 'apparentTemperature': -1.35, 'dewPoint': 2.24, 'humidity': 0.93, 'pressure': 989.3, 'windSpeed': 6.26, 'windGust': 11.11, 'windBearing': 188, 'cloudCover': 0.77, 'uvIndex': 0, 'visibility': 15.157, 'ozone': 312.8}]}, 'daily': {'summary': 'Light rain today through Tuesday.', 'icon': 'rain', 'data': [{'time': 1576105200, 'summary': 'Possible drizzle in the morning.', 'icon': 'rain', 'sunriseTime': 1576134540, 'sunsetTime': 1576162380, 'moonPhase': 0.52, 'precipIntensity': 0.0456, 'precipIntensityMax': 0.1932, 'precipIntensityMaxTime': 1576120440, 'precipProbability': 0.66, 'precipType': 'rain', 'temperatureHigh': 4.58, 'temperatureHighTime': 1576152060, 'temperatureLow': 0.29, 'temperatureLowTime': 1576216440, 'apparentTemperatureHigh': 1.43, 'apparentTemperatureHighTime': 1576152120, 'apparentTemperatureLow': -4.66, 'apparentTemperatureLowTime': 1576216860, 'dewPoint': 0.95, 'humidity': 0.87, 'pressure': 1002.4, 'windSpeed': 3.26, 'windGust': 9.96, 'windGustTime': 1576191600, 'windBearing': 198, 'cloudCover': 0.83, 'uvIndex': 0, 'uvIndexTime': 1576148280, 'visibility': 12.927, 'ozone': 315.3, 'temperatureMin': 1.52, 'temperatureMinTime': 1576110300, 'temperatureMax': 4.58, 'temperatureMaxTime': 1576152060, 'apparentTemperatureMin': -1.8, 'apparentTemperatureMinTime': 1576108800, 'apparentTemperatureMax': 1.43, 'apparentTemperatureMaxTime': 1576152120}, {'time': 1576191600, 'summary': 'Possible drizzle overnight.', 'icon': 'clear-day', 'sunriseTime': 1576221000, 'sunsetTime': 1576248780, 'moonPhase': 0.56, 'precipIntensity': 0.0178, 'precipIntensityMax': 0.3031, 'precipIntensityMaxTime': 1576278000, 'precipProbability': 0.34, 'precipType': 'rain', 'temperatureHigh': 3.55, 'temperatureHighTime': 1576241040, 'temperatureLow': 1.99, 'temperatureLowTime': 1576260000, 'apparentTemperatureHigh': -0.96, 'apparentTemperatureHighTime': 1576242300, 'apparentTemperatureLow': -1.65, 'apparentTemperatureLowTime': 1576260000, 'dewPoint': -0.47, 'humidity': 0.83, 'pressure': 987.4, 'windSpeed': 4.93, 'windGust': 13.77, 'windGustTime': 1576217640, 'windBearing': 145, 'cloudCover': 0.38, 'uvIndex': 0, 'uvIndexTime': 1576234860, 'visibility': 15.289, 'ozone': 326.8, 'temperatureMin': 0.29, 'temperatureMinTime': 1576216440, 'temperatureMax': 3.92, 'temperatureMaxTime': 1576278000, 'apparentTemperatureMin': -4.66, 'apparentTemperatureMinTime': 1576216860, 'apparentTemperatureMax': 0.11, 'apparentTemperatureMaxTime': 1576278000}, {'time': 1576278000, 'summary': 'Light rain until evening.', 'icon': 'rain', 'sunriseTime': 1576307460, 'sunsetTime': 1576335180, 'moonPhase': 0.59, 'precipIntensity': 0.2567, 'precipIntensityMax': 0.717, 'precipIntensityMaxTime': 1576332720, 'precipProbability': 0.92, 'precipType': 'rain', 'temperatureHigh': 6.67, 'temperatureHighTime': 1576336680, 'temperatureLow': 2.74, 'temperatureLowTime': 1576378500, 'apparentTemperatureHigh': 1.61, 'apparentTemperatureHighTime': 1576336860, 'apparentTemperatureLow': -0.53, 'apparentTemperatureLowTime': 1576379820, 'dewPoint': 2.46, 'humidity': 0.88, 'pressure': 991.2, 'windSpeed': 6.19, 'windGust': 16.82, 'windGustTime': 1576338120, 'windBearing': 224, 'cloudCover': 0.81, 'uvIndex': 0, 'uvIndexTime': 1576321260, 'visibility': 15.027, 'ozone': 315.5, 'temperatureMin': 3.04, 'temperatureMinTime': 1576322220, 'temperatureMax': 6.67, 'temperatureMaxTime': 1576336680, 'apparentTemperatureMin': -1.43, 'apparentTemperatureMinTime': 1576323180, 'apparentTemperatureMax': 1.61, 'apparentTemperatureMaxTime': 1576336860}, {'time': 1576364400, 'summary': 'Light rain in the morning.', 'icon': 'rain', 'sunriseTime': 1576393920, 'sunsetTime': 1576421580, 'moonPhase': 0.63, 'precipIntensity': 0.1615, 'precipIntensityMax': 1.2201, 'precipIntensityMaxTime': 1576400880, 'precipProbability': 0.74, 'precipType': 'rain', 'temperatureHigh': 8.79, 'temperatureHighTime': 1576410900, 'temperatureLow': 2.77, 'temperatureLowTime': 1576461840, 'apparentTemperatureHigh': 4.71, 'apparentTemperatureHighTime': 1576410840, 'apparentTemperatureLow': -0.83, 'apparentTemperatureLowTime': 1576462440, 'dewPoint': 2.16, 'humidity': 0.84, 'pressure': 1003, 'windSpeed': 5.6, 'windGust': 18.71, 'windGustTime': 1576409400, 'windBearing': 225, 'cloudCover': 0.46, 'uvIndex': 0, 'uvIndexTime': 1576407600, 'visibility': 16.093, 'ozone': 331.1, 'temperatureMin': 2.74, 'temperatureMinTime': 1576378500, 'temperatureMax': 8.79, 'temperatureMaxTime': 1576410900, 'apparentTemperatureMin': -0.64, 'apparentTemperatureMinTime': 1576448520, 'apparentTemperatureMax': 4.71, 'apparentTemperatureMaxTime': 1576410840}, {'time': 1576450800, 'summary': 'Possible light rain in the evening and overnight.', 'icon': 'rain', 'sunriseTime': 1576480380, 'sunsetTime': 1576508040, 'moonPhase': 0.66, 'precipIntensity': 0.0993, 'precipIntensityMax': 0.6801, 'precipIntensityMaxTime': 1576529460, 'precipProbability': 0.72, 'precipType': 'rain', 'temperatureHigh': 8.53, 'temperatureHighTime': 1576501320, 'temperatureLow': 4.69, 'temperatureLowTime': 1576565700, 'apparentTemperatureHigh': 6.36, 'apparentTemperatureHighTime': 1576501920, 'apparentTemperatureLow': 2.6, 'apparentTemperatureLowTime': 1576566000, 'dewPoint': 4.34, 'humidity': 0.92, 'pressure': 1011.5, 'windSpeed': 3.56, 'windGust': 13.43, 'windGustTime': 1576483380, 'windBearing': 199, 'cloudCover': 0.82, 'uvIndex': 0, 'uvIndexTime': 1576494000, 'visibility': 15.988, 'ozone': 327.9, 'temperatureMin': 2.77, 'temperatureMinTime': 1576461840, 'temperatureMax': 8.53, 'temperatureMaxTime': 1576501320, 'apparentTemperatureMin': -0.83, 'apparentTemperatureMinTime': 1576462440, 'apparentTemperatureMax': 6.36, 'apparentTemperatureMaxTime': 1576501920}, {'time': 1576537200, 'summary': 'Overcast throughout the day.', 'icon': 'rain', 'sunriseTime': 1576566780, 'sunsetTime': 1576594440, 'moonPhase': 0.7, 'precipIntensity': 0.0139, 'precipIntensityMax': 0.1427, 'precipIntensityMaxTime': 1576537200, 'precipProbability': 0.45, 'precipType': 'rain', 'temperatureHigh': 9.58, 'temperatureHighTime': 1576605600, 'temperatureLow': 4.86, 'temperatureLowTime': 1576647780, 'apparentTemperatureHigh': 6.82, 'apparentTemperatureHighTime': 1576605600, 'apparentTemperatureLow': 2.23, 'apparentTemperatureLowTime': 1576647900, 'dewPoint': 5.91, 'humidity': 0.91, 'pressure': 1009.8, 'windSpeed': 3.71, 'windGust': 15.32, 'windGustTime': 1576606560, 'windBearing': 183, 'cloudCover': 1, 'uvIndex': 0, 'uvIndexTime': 1576580460, 'visibility': 16.093, 'ozone': 339.2, 'temperatureMin': 4.69, 'temperatureMinTime': 1576565700, 'temperatureMax': 10.03, 'temperatureMaxTime': 1576613460, 'apparentTemperatureMin': 2.6, 'apparentTemperatureMinTime': 1576566780, 'apparentTemperatureMax': 7.23, 'apparentTemperatureMaxTime': 1576612800}, {'time': 1576623600, 'summary': 'Mostly cloudy throughout the day.', 'icon': 'partly-cloudy-day', 'sunriseTime': 1576653240, 'sunsetTime': 1576680840, 'moonPhase': 0.74, 'precipIntensity': 0.012, 'precipIntensityMax': 0.1178, 'precipIntensityMaxTime': 1576626360, 'precipProbability': 0.16, 'precipType': 'rain', 'temperatureHigh': 8.24, 'temperatureHighTime': 1576669680, 'temperatureLow': 2.2, 'temperatureLowTime': 1576734780, 'apparentTemperatureHigh': 5.65, 'apparentTemperatureHighTime': 1576670040, 'apparentTemperatureLow': -0.22, 'apparentTemperatureLowTime': 1576735800, 'dewPoint': 4.54, 'humidity': 0.91, 'pressure': 1018.9, 'windSpeed': 3.1, 'windGust': 11.26, 'windGustTime': 1576623600, 'windBearing': 245, 'cloudCover': 0.55, 'uvIndex': 0, 'uvIndexTime': 1576666980, 'visibility': 16.093, 'ozone': 352.2, 'temperatureMin': 3.99, 'temperatureMinTime': 1576710000, 'temperatureMax': 8.74, 'temperatureMaxTime': 1576623600, 'apparentTemperatureMin': 2.23, 'apparentTemperatureMinTime': 1576647900, 'apparentTemperatureMax': 5.74, 'apparentTemperatureMaxTime': 1576623600}, {'time': 1576710000, 'summary': 'Overcast throughout the day.', 'icon': 'cloudy', 'sunriseTime': 1576739700, 'sunsetTime': 1576767240, 'moonPhase': 0.77, 'precipIntensity': 0.0016, 'precipIntensityMax': 0.0162, 'precipIntensityMaxTime': 1576789200, 'precipProbability': 0.01, 'precipType': 'rain', 'temperatureHigh': 7.66, 'temperatureHighTime': 1576760220, 'temperatureLow': 4.14, 'temperatureLowTime': 1576818540, 'apparentTemperatureHigh': 5.2, 'apparentTemperatureHighTime': 1576760400, 'apparentTemperatureLow': 1.09, 'apparentTemperatureLowTime': 1576819320, 'dewPoint': 4.29, 'humidity': 0.97, 'pressure': 1022, 'windSpeed': 2.8, 'windGust': 6.72, 'windGustTime': 1576755540, 'windBearing': 137, 'cloudCover': 0.79, 'uvIndex': 0, 'uvIndexTime': 1576753380, 'visibility': 16.093, 'ozone': 319.6, 'temperatureMin': 2.2, 'temperatureMinTime': 1576734780, 'temperatureMax': 7.66, 'temperatureMaxTime': 1576760220, 'apparentTemperatureMin': -0.22, 'apparentTemperatureMinTime': 1576735800, 'apparentTemperatureMax': 5.2, 'apparentTemperatureMaxTime': 1576760400}]}, 'flags': {'sources': ['meteoalarm', 'cmc', 'gfs', 'icon', 'isd', 'madis'], 'meteoalarm-license': 'Based on data from EUMETNET - MeteoAlarm [https://www.meteoalarm.eu/]. Time delays between this website and the MeteoAlarm website are possible; for the most up to date information about alert levels as published by the participating National Meteorological Services please use the MeteoAlarm website.', 'nearest-station': 4.261, 'units': 'si'}, 'offset': 1}
    hourly_temp = {}
    for hour_data in dummy_data["hourly"]["data"]:
        hourly_temp.update({datetime.fromtimestamp(hour_data["time"]):hour_data["temperature"]})
    return hourly_temp
    # return requests.get(weather_api_url + api_path).json()


def get_thryve_data(df_path:str):
    return pd.read_csv(df_path)